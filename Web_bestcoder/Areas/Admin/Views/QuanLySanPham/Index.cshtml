@{
    ViewData["Title"] = "QuanLySanPham";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model IEnumerable<Web_bestcoder.Data.Product>

<main class="app-content">
    <div class="app-title">
        <ul class="app-breadcrumb breadcrumb side">
            <li class="breadcrumb-item active"><a href="#"><b>Danh sách sản phẩm</b></a></li>
        </ul>
        <div id="clock"></div>
    </div>
    
    <div class="row">
        <div class="col-md-12">
            <div class="tile">
                <div class="tile-body">
                    <div class="row element-button">
                        <div class="col-sm-2">
                            <a class="btn btn-add btn-sm" asp-controller="QuanLySanPham" asp-action="ThemSanPham" title="Thêm">
                                <i class="fas fa-plus"></i> Tạo mới sản phẩm
                            </a>
                        </div>
                    </div>

                    <table class="table table-hover table-bordered" id="sampleTable">
                        <thead>
                            <tr>
                                <th width="10"><input type="checkbox" id="all"></th>
                                <th>Mã sản phẩm</th>
                                <th>Tên sản phẩm</th>
                                <th>Ảnh</th>
                                <th>Số lượng</th>
                                <th>Tình trạng</th>
                                <th>Giá tiền</th>
                                <th>Danh mục</th>
                                <th>Chức năng</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model != null)
                            {
                                foreach (var item in Model)
                                {
                                    <tr>
                                        <td width="10">
                                            <input type="checkbox" name="check1" value="@item.ProductId">
                                        </td>
                                        <td>@item.ProductId</td>
                                        <td>@item.ProductName ?? "N/A"</td>
                                        <td>
                                            <img src="@Url.Content("~/img-sanpham/" + (item.Image ?? "default.jpg"))" 
                                                 alt="Image" width="100px">
                                        </td>
                                        <td>@item.Quantity ?? 0</td>
                                        <td>
                                            <span class="badge @(item.Status == "Còn hàng" ? "bg-success" : "bg-danger")">
                                                @item.Status ?? "Không xác định"
                                            </span>
                                        </td>
                                        <td>@item.SellingPrice.ToString("N0") ?? "0"</td>
                                        <td>@item.Category ?? "Chưa phân loại"</td>
                                        <td>
                                            <a class="btn btn-primary btn-sm trash" type="button" title="Xóa" onclick="deleteRow(this)">
                                                <i class="fas fa-trash-alt"></i>
                                            </a>
                                            <button asp-action="Update" asp-controller="QuanLySanPham" 
                                                    class="btn btn-primary btn-sm edit" type="button" title="Sửa" 
                                                    data-toggle="modal" data-target="#ModalUP">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="9" class="text-center">Không có sản phẩm nào để hiển thị</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- JavaScript for table and delete functionality -->
<script src="~/js/plugins/pace.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
<script src="~/js/plugins/jquery.dataTables.min.js"></script>
<script src="~/js/plugins/dataTables.bootstrap.min.js"></script>
<script>
    // Function to delete a row from the table
    function deleteRow(element) {
        $(element).closest('tr').remove();
    }

    // Initializing data table
    $(document).ready(function() {
        $('#sampleTable').DataTable();
        $('#all').click(function () {
            $('#sampleTable tbody :checkbox').prop('checked', $(this).is(':checked'));
        });
    });
</script>
